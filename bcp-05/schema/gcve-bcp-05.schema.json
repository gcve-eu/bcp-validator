{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://gcve.eu/bcp/bcp-05/gcve-bcp-05.schema.json",
  "title": "GCVE-BCP-05 extension validator (x_gcve)",
  "description": "Validates the GCVE extension object(s) as described in GCVE-BCP-05. This schema intentionally does not fully validate the underlying CVE Record Format.",
  "oneOf": [
    {
      "$ref": "#/$defs/CVERecord"
    },
    {
      "type": "array",
      "items": {
        "$ref": "#/$defs/CVERecord"
      }
    }
  ],
  "$defs": {
    "CVERecord": {
      "type": "object",
      "required": [
        "dataType",
        "dataVersion",
        "cveMetadata",
        "containers"
      ],
      "properties": {
        "dataType": {
          "type": "string"
        },
        "dataVersion": {
          "type": "string"
        },
        "cveMetadata": {
          "type": "object"
        },
        "containers": {
          "type": "object"
        },
        "x_gcve": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/GCVEExtension"
          }
        }
      },
      "additionalProperties": true
    },
    "GCVEExtension": {
      "type": "object",
      "required": [
        "vulnId",
        "recordType"
      ],
      "properties": {
        "vulnId": {
          "type": "string",
          "description": "GCVE identifier. Spec references GCVE-BCP-04; this regex is a permissive approximation accepting case-insensitive GCVE-<digits>-<year>-<serial>.",
          "pattern": "^(?i:GCVE)-[0-9]+-[0-9]{4}-[0-9]{4,}$"
        },
        "recordType": {
          "type": "string",
          "description": "Semantic type of the record. Unknown values are permitted for forward compatibility.",
          "minLength": 1
        },
        "relationships": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Relationship"
          }
        },
        "language": {
          "type": "string",
          "description": "Only used when recordType is translation."
        }
      },
      "patternProperties": {
        "^x_": {
          "type": [
            "object",
            "array",
            "string",
            "number",
            "boolean",
            "null"
          ]
        }
      },
      "additionalProperties": true
    },
    "Relationship": {
      "type": "object",
      "required": [
        "destId",
        "type"
      ],
      "properties": {
        "destId": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "minLength": 1
        },
        "srcId": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": true
    }
  }
}
